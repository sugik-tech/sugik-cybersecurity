## 🐾 Tcpdump: The Basics – Ringkasan Materi & Jawaban

📝 **Deskripsi:**  
Rangkuman ini disusun dengan bantuan AI (ChatGPT) setelah saya menyelesaikan room ini di TryHackMe. Tujuannya adalah untuk merapikan dan menyederhanakan materi agar lebih mudah dipahami dan diingat.

---

### ✅ **Task 1 – Introduction**

* **`tcpdump`** adalah alat baris perintah (CLI) untuk menangkap dan menganalisis paket jaringan secara langsung (live capture) atau dari file yang disimpan.
* Dibangun dengan library **`libpcap`**, yang juga digunakan oleh berbagai tools seperti Wireshark. ([Medium][1])
  **Flag:** nama library → `libpcap`

---

### 📦 **Task 2 – Basic Packet Capture**

* Pilihan penting:

  * `-i INTERFACE` → pilih interface (contoh: `"ens5"` atau `"any"`)
  * `-w FILE` → simpan ke file `.pcap`
  * `-r FILE` → baca dari file `.pcap`
  * `-c COUNT` → batasi jumlah paket
  * `-n` → jangan resolve IP (numerik saja)
  * `-nn` → tidak resolve IP atau port
  * `-v`, `-vv`, `-vvv` → tingkat verbosity output
* **Pertanyaan**: opsi apa untuk menampilkan alamat secara numerik? → `-n` ([Medium][1])

---

### 🎯 **Task 3 – Filtering Expressions**

Gunakan filter BPF:

* `host IP` / `src host IP` / `dst host IP`
* `port 80` / `tcp port 22` / `udp port 53`
* `tcp`, `udp`, `icmp`, `arp`

Contoh:

````
tcpdump host example.com -w http.pcap  
tcpdump icmp -n  
tcpdump udp port 53 -n  
``` :contentReference[oaicite:17]{index=17}

---

### 🔬 **Task 4 – Advanced Filtering**
- Gunakan operator logika: `and`, `or`, `not`  
  - Contoh: `tcpdump host 1.1.1.1 and tcp`
- Header byte access: `proto[offset:size]`  
  - Contoh filter ARP: `arp[24:4] = 0xc0a87c89` (hex untuk IP 192.168.124.137)  
  - Digunakan untuk mencocokkan field byte tertentu di header paket (contoh ARP target IP). :contentReference[oaicite:18]{index=18}

---

### 📊 **Task 5 – Packet Analysis Operations**
- Hitung jumlah paket dari `traffic.pcap`:
  - **ICMP packets** → `tcpdump -r traffic.pcap icmp -n | wc -l` → **26**  
- ARP request: host yang meminta MAC untuk IP `192.168.124.137` → **192.168.124.148**  
  - Filter: `tcpdump -r traffic.pcap arp and 'arp[24:4] = 0xc0a87c89'`  
- DNS query pertama: hostname/subdomain yang muncul → **mirrors.rockylinux.org** :contentReference[oaicite:19]{index=19}

---

### ✨ Summary Icons
Berikut contoh opsi yang sering dipakai:

````

-i INTERFACE     → pilih interface
-w FILE          → simpan ke pcap
-r FILE          → baca pcap
-c COUNT         → batas paket
-n, -nn          → no resolve DNS/port
-v/-vv/-vvv      → verbose output

```

---

## 📝 Template Singkat untuk Catatan Word

```

Tcpdump: The Basics

Task 1:

* Library = libpcap

Task 2 – Basic Capture:

* -i interface
* -w file.pcap
* -r file.pcap
* -c count
* -n (numeric addresses)
* -nn (politeory)
* -v / -vv / -vvv verbosity

Task 3 – Filters:

* host IP, src host, dst host
* tcp, udp, icmp, arp
* port 53 / port 80 / tcp port 22, dll.

Task 4 – Advanced:

* Logical ops: and/or/not
* Proto\[offset\:size]
* Ex: arp\[24:4] = 0xc0a87c89

Task 5 – Packet Analysis:

* ICMP count = 26
* ARP request IP = 192.168.124.148
* DNS query hostname = mirrors.rockylinux.org
